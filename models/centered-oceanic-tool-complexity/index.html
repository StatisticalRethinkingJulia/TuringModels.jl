<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel="shortcut icon" type="image/png" href="/TuringModels.jl/assets/favicon.png"/> <link rel=stylesheet  href="/TuringModels.jl/libs/highlight/github.min.css"> <link rel=stylesheet  href="/TuringModels.jl/css/franklin.css"> <title>Centered oceanic tool complexity</title> <div class=franklin-content > <div class=top-bar > <a href="/TuringModels.jl/">TuringModels</a> </div> <h1>Centered oceanic tool complexity</h1> </div> <div class=franklin-content > <p>This is model <code>m10.10stan.c</code> in Statistical Rethinking Edition 1. The model aims to show how centering predictors can reduce running time when parameters are highly correlated.</p> <div class=franklin-toc ><ol><li><a href="#data">Data</a><li><a href="#model">Model</a><li><a href="#original_output">Original output</a></ol></div> <h2 id=data ><a href="#data" class=header-anchor >Data</a></h2> <pre><code class=language-julia >import CSV
import Random
import TuringModels

using DataFrames
using Statistics: mean

Random.seed&#33;&#40;1&#41;

data_path &#61; joinpath&#40;TuringModels.project_root, &quot;data&quot;, &quot;Kline.csv&quot;&#41;
df &#61; CSV.read&#40;data_path, DataFrame; delim&#61;&#39;;&#39;&#41;

df.log_pop &#61; log.&#40;df.population&#41;
df.contact_high &#61; &#91;contact &#61;&#61; &quot;high&quot; ? 1 : 0 for contact in df.contact&#93;</code></pre><pre><code class="plaintext code-output">10-element Vector{Int64}:
 0
 0
 0
 1
 1
 1
 1
 0
 1
 0</code></pre> <p>New col where we center&#40;&#33;&#41; the log_pop values</p> <pre><code class=language-julia >mean_log_pop &#61; mean&#40;df.log_pop&#41;
df.log_pop_c &#61; map&#40;x -&gt; x - mean_log_pop, df.log_pop&#41;
df</code></pre><pre><code class="plaintext code-output">10×8 DataFrame
 Row │ culture     population  contact  total_tools  mean_TU  log_pop   contact_high  log_pop_c
     │ String15    Int64       String7  Int64        Float64  Float64   Int64         Float64
─────┼───────────────────────────────────────────────────────────────────────────────────────────
   1 │ Malekula          1100  low               13      3.2   7.00307             0  -1.97394
   2 │ Tikopia           1500  low               22      4.7   7.31322             0  -1.66378
   3 │ Santa Cruz        3600  low               24      4.0   8.18869             0  -0.788316
   4 │ Yap               4791  high              43      5.0   8.47449             1  -0.50251
   5 │ Lau Fiji          7400  high              33      5.0   8.90924             1  -0.0677695
   6 │ Trobriand         8000  high              19      4.0   8.9872              1   0.0101921
   7 │ Chuuk             9200  high              40      3.8   9.12696             1   0.149954
   8 │ Manus            13000  low               28      6.6   9.4727              0   0.4957
   9 │ Tonga            17500  high              55      5.4   9.76996             1   0.792951
  10 │ Hawaii          275000  low               71      6.6  12.5245              0   3.54752</code></pre> <h2 id=model ><a href="#model" class=header-anchor >Model</a></h2> <pre><code class=language-julia >using Turing

@model function m10_10stan_c&#40;total_tools, log_pop_c, contact_high&#41;
    α ~ Normal&#40;0, 100&#41;
    βp ~ Normal&#40;0, 1&#41;
    βc ~ Normal&#40;0, 1&#41;
    βpc ~ Normal&#40;0, 1&#41;

    for i ∈ 1:length&#40;total_tools&#41;
        λ &#61; exp&#40;α &#43; βp*log_pop_c&#91;i&#93; &#43; βc*contact_high&#91;i&#93; &#43;
            βpc*contact_high&#91;i&#93;*log_pop_c&#91;i&#93;&#41;
        total_tools&#91;i&#93; ~ Poisson&#40;λ&#41;
    end
end;

chns &#61; sample&#40;
    m10_10stan_c&#40;df.total_tools, df.log_pop_c, df.contact_high&#41;,
    NUTS&#40;&#41;,
    1000
&#41;</code></pre><pre><code class="plaintext code-output">Chains MCMC chain (1000×16×1 Array{Float64, 3}):

Iterations        = 501:1:1500
Number of chains  = 1
Samples per chain = 1000
Wall duration     = 3.41 seconds
Compute duration  = 3.41 seconds
parameters        = α, βp, βc, βpc
internals         = lp, n_steps, is_accept, acceptance_rate, log_density, hamiltonian_energy, hamiltonian_energy_error, max_hamiltonian_energy_error, tree_depth, numerical_error, step_size, nom_step_size

Summary Statistics
  parameters      mean       std   naive_se      mcse        ess      rhat   ess_per_sec
      Symbol   Float64   Float64    Float64   Float64    Float64   Float64       Float64

           α    3.3080    0.0901     0.0028    0.0037   714.0783    1.0069      209.5300
          βp    0.2623    0.0363     0.0011    0.0014   773.7110    0.9995      227.0279
          βc    0.2876    0.1196     0.0038    0.0048   723.8301    1.0053      212.3915
         βpc    0.0627    0.1746     0.0055    0.0054   803.7383    0.9990      235.8387

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           α    3.1246    3.2481    3.3111    3.3717    3.4747
          βp    0.1896    0.2388    0.2627    0.2865    0.3348
          βc    0.0683    0.2035    0.2849    0.3672    0.5283
         βpc   -0.2845   -0.0591    0.0608    0.1812    0.4103
</code></pre> </p> <pre><code class=language-julia >using StatsPlots

StatsPlots.plot&#40;chns&#41;</code></pre><pre><code class="plaintext code-output">"/home/runner/work/TuringModels.jl/TuringModels.jl/__site/assets/models/centered-oceanic-tool-complexity/code/output/chns.svg"</code></pre>
<p> <img src="/TuringModels.jl/assets/models/centered-oceanic-tool-complexity/code/output/chns.svg" alt="">
<h2 id=original_output ><a href="#original_output" class=header-anchor >Original output</a></h2>
<pre><code class=language-julia >m_10_10t_c_result &#61; &quot;
    mean   sd  5.5&#37; 94.5&#37; n_eff Rhat
 a   3.31 0.09  3.17  3.45  3671    1
 bp  0.26 0.03  0.21  0.32  5052    1
 bc  0.28 0.12  0.10  0.47  3383    1
 bcp 0.07 0.17 -0.20  0.34  4683    1
&quot;;</code></pre>

<div class=page-foot >
  <div class=copyright >
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>
    Rob Goedman, Richard Torkar, Rik Huijzer, Martin Trapp and contributors. Last modified: December 15, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    
    
        <script src="/TuringModels.jl/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>